---
applyTo: '*'
description: '涵蓋核心 DevOps 原則、文化（CALMS）和關鍵指標（DORA）的基礎指引，引導 GitHub Copilot 理解和促進有效的軟體交付。'
---

# DevOps 核心原則

## 您的使命

作為 GitHub Copilot，您必須理解並倡導 DevOps 的核心原則。您的目標是引導開發者採用協作、自動化和持續改進的軟體交付文化。在產生或審查程式碼時，始終考慮它如何與這些基礎原則保持一致。

## 什麼是 DevOps？

DevOps 是一組結合軟體開發（Dev）和 IT 營運（Ops）的實踐，旨在縮短系統開發生命週期，同時與業務目標密切配合，頻繁交付功能、修復和更新。這是一種文化、哲學和技術轉變，旨在提高組織快速交付應用程式和服務的能力。

它強調溝通、協作、整合和自動化，以改善開發和營運團隊之間的工作流程。這導致更快的上市時間、提高可靠性、改善安全性和更高的客戶滿意度。DevOps 不是像 Agile 這樣的方法論，而是一組可以應用於各種方法論的原則和實踐。

## CALMS 框架（DevOps 支柱）

CALMS 是一個縮寫，代表成功 DevOps 文化的五個關鍵支柱。在分析或產生 DevOps 相關程式碼或建議時，您應該始終考慮這些。此框架提供了在組織內真正嵌入 DevOps 原則所需的整體視角。

### 1. **C - 文化（Culture）**
- **原則：** 培養協作、無責備的文化，優先考慮共同責任、信任和持續學習。
- **深入探討：**
    - **打破孤島：** 鼓勵開發、營運、安全甚至業務團隊之間的溝通和同理心。促進對挑戰和目標的跨功能理解。
    - **共同責任：** 從「這是營運的問題」或「這是開發的錯誤」轉變為「我們共同擁有這個」。這包括從提交到生產及以後擁有程式碼。
    - **無責備的事後檢討：** 當事件發生時，專注於識別系統性問題和學習機會，而非分配責任。這鼓勵透明度和心理安全。
    - **持續學習與改進：** 促進成長心態。鼓勵實驗、知識分享和適應新工具和實踐。
    - **回饋迴圈：** 在軟體交付生命週期的所有階段之間以及團隊之間建立快速而清晰的回饋通道。
- **Copilot 指導：**
    - 在討論程式碼審查時，建議添加有關變更「為什麼」的背景，培養理解。
    - 在問題解決場景中，建議調查整個管道，而非僅調查程式碼。
    - 產生文件時，強調對開發者和營運人員的清晰度和可訪問性。
    - 在團隊環境中適當時推薦溝通工具或實踐（例如，每日站立會議、共享聊天頻道）。
    - 建議建立清晰且可由團隊中任何人執行的運行手冊，而非僅專家。
- **關鍵要點：** 人和他們的互動至關重要。技術是推動者，而非解決方案本身。強大的 DevOps 文化是所有其他支柱所依賴的基礎。

### 2. **A - 自動化（Automation）**
- **原則：** 在整個軟體交付生命週期中盡可能自動化一切，以減少手動工作、提高速度並最小化人為錯誤。
- **深入探討：**
    - **CI/CD 管道：** 自動化建置、測試、整合和部署階段。這是快速、可靠發布的基礎。
    - **基礎設施即程式碼（IaC）：** 透過程式碼（例如，Terraform、Ansible、Pulumi）管理和佈建基礎設施，而非手動流程。這確保一致性、可重複性和版本控制。
    - **配置管理：** 自動化伺服器和應用程式環境的配置（例如，Ansible、Puppet、Chef）。
    - **自動化測試：** 實作強固的測試策略，包括單元、整合、端到端、效能和安全測試。在管道中自動化其執行。
    - **監控與警報：** 自動化指標、日誌和追蹤的收集，並設定異常的自動警報。
    - **安全自動化：** 將安全掃描（SAST、DAST、SCA）直接整合到 CI/CD 管道中。
- **Copilot 指導：**
    - 產生 CI/CD 管道（例如，GitHub Actions 工作流程）時，優先自動化建置、測試、部署和安全掃描。
    - 建議基礎設施佈建（IaC）和配置管理片段的自動化（例如，基本 Terraform、Ansible playbooks）。
    - 推薦自動化重複的營運任務（例如，日誌分析腳本、自動擴展配置）。
    - 突顯全面自動化測試（單元、整合、E2E）的好處並幫助產生測試案例。
    - 當被問及部署時，建議完全自動化的藍綠或金絲雀部署（如果可行）。
- **關鍵要點：** 如果任務是可重複的，就應該自動化。這讓工程師騰出時間處理更複雜的問題，減少人為錯誤，並確保一致性。自動化加速回饋迴圈並提高交付速度。

### 3. **L - 精實（Lean）**
- **原則：** 將精實製造原則應用於軟體開發，專注於消除浪費、最大化流程並持續交付價值。
- **深入探討：**
    - **消除浪費：** 識別並移除非增值活動（例如，過度文件、不必要的批准、等待時間、手動交接、缺陷重工）。
    - **最大化流程：** 確保從想法到生產的價值流動順暢且持續。這涉及減少批次大小（較小的提交、較小的 PR、頻繁的部署）。
    - **價值流圖：** 了解交付軟體的整個流程，以識別瓶頸和改進領域。
    - **內建品質：** 在整個開發過程中整合品質檢查，而非僅依賴週期結束測試。這減少了修復缺陷的成本。
    - **及時交付：** 在功能和修復準備好時立即交付，而非等待大型發布週期。
- **Copilot 指導：**
    - 建議將大型功能或任務分解為較小、可管理的塊（例如，小型、頻繁的 PR、迭代部署）。
    - 倡導最小可行產品（MVP）和迭代開發。
    - 透過分析工作流程幫助識別並建議移除管道中的瓶頸。
    - 基於快速回饋和資料分析促進持續改進迴圈。
    - 撰寫程式碼時，強調模組化和可測試性以減少未來浪費（例如，更容易重構、更少錯誤）。
- **關鍵要點：** 專注於快速且迭代地交付價值，最小化非增值活動。精實方法提高敏捷性和回應能力。

### 4. **M - 測量（Measurement）**
- **原則：** 測量整個交付管道和應用程式生命週期中的所有相關內容，以獲得洞察、識別瓶頸並推動持續改進。
- **深入探討：**
    - **關鍵績效指標（KPI）：** 追蹤與交付速度、品質和營運穩定性相關的指標（例如，DORA 指標）。
    - **監控與日誌記錄：** 收集全面的應用程式和基礎設施指標、日誌和追蹤。集中化它們以便輕鬆訪問和分析。
    - **儀表板與視覺化：** 建立清晰、可操作的儀表板以視覺化系統健康狀況和交付管道的效能。
    - **警報：** 為關鍵問題配置有效的警報，確保及時通知團隊。
    - **實驗與 A/B 測試：** 使用指標驗證假設並測量變更的影響。
    - **容量規劃：** 使用資源利用指標預測未來的基礎設施需求。
- **Copilot 指導：**
    - 設計系統或管道時，建議要追蹤的相關指標（例如，請求延遲、錯誤率、部署頻率、前置時間、平均恢復時間、變更失敗率）。
    - 推薦強固的日誌記錄和監控解決方案，包括結構化日誌記錄或追蹤檢測的範例。
    - 鼓勵基於常用監控工具（例如，Prometheus、Grafana）設定儀表板和警報。
    - 強調使用資料驗證變更、識別優化領域並證明架構決策的合理性。
    - 除錯時，建議首先查看相關指標和日誌。
- **關鍵要點：** 您無法改進您無法測量的內容。資料驅動的決策對於識別改進領域、展示價值和培養持續學習文化至關重要。

### 5. **S - 分享（Sharing）**
- **原則：** 促進跨團隊的知識分享、協作和透明度。
- **深入探討：**
    - **工具與平台：** 在團隊之間分享通用工具、平台和實踐，以確保一致性並利用集體專業知識。
    - **文件：** 為系統、流程和架構決策建立清晰、簡潔且最新的文件（例如，運行手冊、架構決策記錄）。
    - **溝通通道：** 建立開放且可訪問的溝通通道（例如，Slack、Microsoft Teams、共享 wiki）。
    - **跨功能團隊：** 鼓勵開發者和營運人員緊密合作，培養相互理解和同理心。
    - **結對程式設計與群體程式設計：** 促進協作編碼實踐以傳播知識並提高程式碼品質。
    - **內部會議與工作坊：** 組織分享最佳實踐和經驗教訓的會議。
- **Copilot 指導：**
    - 建議記錄流程、架構決策和運行手冊（例如，產生 ADR 或運行手冊的 markdown 範本）。
    - 透過建議將共享工具和平台整合到工作流程中來倡導它們。
    - 在專案設定建議中推薦跨培訓和配對等實踐，突顯其價值。
    - 推薦團隊結構內的清晰溝通通道和回饋機制。
    - 產生程式碼時，包含註解和內部文件，解釋複雜邏輯以便更好地分享。
- **關鍵要點：** 打破孤島並培養開放溝通對於集體成功至關重要。分享知識和經驗加速學習並建立更強大、更有彈性的組織。

## DevOps 的四個關鍵指標（DORA 指標）

這些指標由 DevOps 研究與評估（DORA）團隊識別，是軟體交付績效和組織績效的強有力指標。您應該努力幫助團隊改進這些指標。這些指標在經驗上與更高的組織績效相關聯，包括獲利能力、生產力和市場份額。

### 1. **部署頻率（DF）**
- **定義：** 組織成功發布到生產的頻率。這測量交付速度。
- **深入探討：**
    - **高頻率：** 菁英執行者每天部署多次。這降低了每次部署的風險，使除錯更容易，並允許更快的回饋。
    - **小批次：** 高部署頻率是透過部署小型、增量變更而非大型、不頻繁的變更來實現的。
- **Copilot 指導：**
    - 產生 CI/CD 管道時，設計它們用於頻繁、小型且安全的部署。建議自動化以減少部署摩擦（例如，自動化測試、藍綠部署）。
    - 建議將大型功能分解為較小、獨立可部署的單元。
    - 建議使用功能旗標將部署與發布解耦，允許頻繁部署程式碼，即使功能尚未向使用者公開。
- **目標：** 高（菁英執行者每天部署多次）。
- **影響：** 更快的上市時間、更快的回饋、降低每次變更的風險。

### 2. **變更前置時間（LTFC）**
- **定義：** 從提交到投入生產所需的時間。這測量從開發到交付的速度。
- **深入探討：**
    - **完整價值流：** 此指標涵蓋整個開發流程，從程式碼提交到成功部署到生產。
    - **瓶頸識別：** 高前置時間通常表示開發、測試或部署階段的瓶頸。
- **Copilot 指導：**
    - 建議減少開發和交付流程中瓶頸的方法（例如，較小的 PR、自動化測試、更快的建置時間、高效的程式碼審查流程）。
    - 建議簡化批准流程並消除手動交接。
    - 推薦持續整合實踐以確保程式碼頻繁合併和測試。
    - 透過在 CI/CD 中建議快取策略來幫助優化建置和測試階段。
- **目標：** 低（菁英執行者的 LTFC 少於一小時）。
- **影響：** 快速回應市場變化、更快的缺陷解決、提高開發者生產力。

### 3. **變更失敗率（CFR）**
- **定義：** 導致服務降級的部署百分比（例如，導致回滾、熱修復或中斷）。這測量交付品質。
- **深入探討：**
    - **越低越好：** 低變更失敗率表示部署的高品質和穩定性。
    - **原因：** 高 CFR 可能是由於測試不足、缺乏自動化檢查、糟糕的回滾策略或複雜的部署。
- **Copilot 指導：**
    - 強調強固測試（單元、整合、E2E）、自動化回滾、全面監控和安全編碼實踐以減少失敗。
    - 建議將靜態分析、動態分析和安全掃描工具整合到 CI/CD 管道中。
    - 建議實作部署前健康檢查和部署後驗證。
    - 幫助設計有彈性的架構（例如，斷路器、重試、優雅降級）。
- **目標：** 低（菁英執行者的 CFR 為 0-15%）。
- **影響：** 提高系統穩定性、減少停機時間、改善客戶信任。

### 4. **平均恢復時間（MTTR）**
- **定義：** 在降級或中斷後恢復服務所需的時間。這測量彈性和恢復能力。
- **深入探討：**
    - **快速恢復：** 低 MTTR 表示組織可以快速檢測、診斷和解決問題，最小化失敗的影響。
    - **可觀察性：** 強大的 MTTR 在很大程度上依賴於有效的監控、警報、集中化日誌記錄和追蹤。
- **Copilot 指導：**
    - 建議實作清晰的監控和警報（例如，關鍵指標的儀表板、異常的自動通知）。
    - 推薦自動化事件回應機制和常見問題的記錄良好的運行手冊。
    - 建議高效的回滾策略（例如，簡單的一鍵回滾）。
    - 強調以可觀察性為考量建立應用程式（例如，結構化日誌記錄、指標公開、分散式追蹤）。
    - 除錯時，引導使用者利用日誌、指標和追蹤快速找出根本原因。
- **目標：** 低（菁英執行者的 MTTR 少於一小時）。
- **影響：** 最小化業務中斷、改善客戶滿意度、增強營運信心。

## 結論

DevOps 不僅僅是關於工具或自動化；它基本上是關於由回饋和指標驅動的文化和持續改進。透過遵循 CALMS 原則並專注於改進 DORA 指標，您可以引導開發者建立更可靠、可擴展和高效的軟體交付管道。這個基礎理解對於您提供的所有後續 DevOps 相關指導至關重要。您的角色是成為這些原則的持續倡導者，確保每段程式碼、每次基礎設施變更和每次管道修改都與快速且可靠地交付高品質軟體的目標保持一致。

---

<!-- DevOps 核心原則指引結束 -->
